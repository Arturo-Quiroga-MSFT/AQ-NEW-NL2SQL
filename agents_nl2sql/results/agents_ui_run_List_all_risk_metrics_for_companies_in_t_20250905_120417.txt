Query: List all risk metrics for companies in the Technology industry.

Intent & Entities: List all risk metrics for companies in the Technology industry.

Generated SQL:
WITH TechCompanies AS (
  SELECT c.CompanyId, c.CompanyName, c.Industry, c.CountryCode
  FROM dbo.Company c
  WHERE c.Industry = 'Technology'
),
RiskMetrics AS (
  SELECT rmh.CompanyId, rmh.AsOfDate, rmh.MetricName, rmh.MetricValue, rmh.Source
  FROM dbo.RiskMetricHistory rmh
)
SELECT 
  tc.CompanyId,
  COALESCE(cp.LegalName, tc.CompanyName) AS CompanyName,
  tc.Industry,
  ct.CountryName,
  r.RegionName,
  rm.MetricName,
  rm.AsOfDate,
  rm.MetricValue,
  rm.Source
FROM TechCompanies tc
JOIN RiskMetrics rm ON rm.CompanyId = tc.CompanyId
LEFT JOIN dbo.CustomerProfile cp ON cp.CompanyId = tc.CompanyId
LEFT JOIN ref.Country ct ON tc.CountryCode = ct.CountryCode
LEFT JOIN ref.Region r ON ct.RegionId = r.RegionId
ORDER BY CompanyName, rm.AsOfDate DESC, rm.MetricName

Sanitized SQL:
WITH TechCompanies AS (
  SELECT c.CompanyId, c.CompanyName, c.Industry, c.CountryCode
  FROM dbo.Company c
  WHERE c.Industry = 'Technology'
),
RiskMetrics AS (
  SELECT rmh.CompanyId, rmh.AsOfDate, rmh.MetricName, rmh.MetricValue, rmh.Source
  FROM dbo.RiskMetricHistory rmh
)
SELECT 
  tc.CompanyId,
  COALESCE(cp.LegalName, tc.CompanyName) AS CompanyName,
  tc.Industry,
  ct.CountryName,
  r.RegionName,
  rm.MetricName,
  rm.AsOfDate,
  rm.MetricValue,
  rm.Source
FROM TechCompanies tc
JOIN RiskMetrics rm ON rm.CompanyId = tc.CompanyId
LEFT JOIN dbo.CustomerProfile cp ON cp.CompanyId = tc.CompanyId
LEFT JOIN ref.Country ct ON tc.CountryCode = ct.CountryCode
LEFT JOIN ref.Region r ON ct.RegionId = r.RegionId
ORDER BY CompanyName, rm.AsOfDate DESC, rm.MetricName

Results Preview:
CompanyId | CompanyName               | Industry   | CountryName | RegionName | MetricName | AsOfDate   | MetricValue | Source
----------+---------------------------+------------+-------------+------------+------------+------------+-------------+-------
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | DSCR       | 2025-06-30 | 1.1000      | Model 
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | Leverage   | 2025-06-30 | 2.7100      | Model 
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | DSCR       | 2025-03-31 | 1.1800      | Model 
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | Leverage   | 2025-03-31 | 3.1100      | Model 
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | DSCR       | 2024-12-31 | 1.2600      | Model 
13        | Amsterdam FinTech BV Ltd. | Technology | Netherlands | Europe     | Leverage   | 2024-12-31 | 3.8600      | Model 

Total pipeline execution time: 20.16 seconds
