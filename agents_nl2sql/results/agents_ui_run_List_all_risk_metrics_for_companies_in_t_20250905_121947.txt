Query: List all risk metrics for companies in the Technology industry.

Intent & Entities (JSON):
{
  "intent": "List all risk metrics for companies in the Technology industry.",
  "error": "'\"intent\"'"
}

Generated SQL:
WITH TechCompanies AS (
  SELECT c.CompanyId, c.CompanyName, c.Industry, c.CountryCode
  FROM dbo.Company c
  WHERE UPPER(LTRIM(RTRIM(c.Industry))) = 'TECHNOLOGY'
), CompanyGeo AS (
  SELECT t.CompanyId, t.CompanyName, t.Industry, ct.CountryName, r.RegionName
  FROM TechCompanies t
  LEFT JOIN ref.Country ct ON t.CountryCode = ct.CountryCode
  LEFT JOIN ref.Region r ON ct.RegionId = r.RegionId
)
SELECT g.CompanyName, g.Industry, COALESCE(g.CountryName, '') AS CountryName, COALESCE(g.RegionName, '') AS RegionName, rm.AsOfDate, rm.MetricName, rm.MetricValue, rm.Source
FROM CompanyGeo g
JOIN dbo.RiskMetricHistory rm ON rm.CompanyId = g.CompanyId
ORDER BY g.CompanyName, rm.AsOfDate DESC, rm.MetricName

Sanitized SQL:
WITH TechCompanies AS (
  SELECT c.CompanyId, c.CompanyName, c.Industry, c.CountryCode
  FROM dbo.Company c
  WHERE UPPER(LTRIM(RTRIM(c.Industry))) = 'TECHNOLOGY'
), CompanyGeo AS (
  SELECT t.CompanyId, t.CompanyName, t.Industry, ct.CountryName, r.RegionName
  FROM TechCompanies t
  LEFT JOIN ref.Country ct ON t.CountryCode = ct.CountryCode
  LEFT JOIN ref.Region r ON ct.RegionId = r.RegionId
)
SELECT g.CompanyName, g.Industry, COALESCE(g.CountryName, '') AS CountryName, COALESCE(g.RegionName, '') AS RegionName, rm.AsOfDate, rm.MetricName, rm.MetricValue, rm.Source
FROM CompanyGeo g
JOIN dbo.RiskMetricHistory rm ON rm.CompanyId = g.CompanyId
ORDER BY g.CompanyName, rm.AsOfDate DESC, rm.MetricName

Results Preview:
CompanyName          | Industry   | CountryName | RegionName | AsOfDate   | MetricName | MetricValue | Source
---------------------+------------+-------------+------------+------------+------------+-------------+-------
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2025-06-30 | DSCR       | 1.1000      | Model 
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2025-06-30 | Leverage   | 2.7100      | Model 
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2025-03-31 | DSCR       | 1.1800      | Model 
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2025-03-31 | Leverage   | 3.1100      | Model 
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2024-12-31 | DSCR       | 1.2600      | Model 
Amsterdam FinTech BV | Technology | Netherlands | Europe     | 2024-12-31 | Leverage   | 3.8600      | Model 

Total pipeline execution time: 31.44 seconds
