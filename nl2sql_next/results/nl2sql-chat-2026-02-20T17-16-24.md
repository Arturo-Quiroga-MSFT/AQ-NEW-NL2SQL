# NL2SQL Chat — 2026-02-20, 12:16:24 p.m.

## Q: What tables are in the database?

Here are the tables in the RetailDW database, organized by schema:

### Dimension Tables (dim)
- dim.DimCustomer
- dim.DimDate
- dim.DimPaymentMethod
- dim.DimProduct
- dim.DimPromotion
- dim.DimShippingMethod
- dim.DimStore

### Fact Tables (fact)
- fact.FactCustomerReview
- fact.FactInventory
- fact.FactOrders
- fact.FactReturns
- fact.FactWebTraffic

### Reference Tables (ref)
- ref.RefReturnReason

There are a total of 13 tables in the database.

## Q: How are orders related to products?

Orders are related to products through the **fact.FactOrders** table:

- **fact.FactOrders.ProductKey** is a foreign key referencing **dim.DimProduct.ProductKey**.
- Each order line in **fact.FactOrders** contains a **ProductKey** that identifies which product was ordered.

**Relationship details:**
- One order (OrderId) can have multiple lines (LineNumber), each line representing a product purchased in that order.
- Each line links to a product via **ProductKey**.
- The product details (name, category, price, etc.) are stored in **dim.DimProduct**.

**Schema Example:**
```plaintext
fact.FactOrders
---------------
OrderId | LineNumber | ProductKey | Quantity | UnitPrice | ...

dim.DimProduct
--------------
ProductKey | ProductId | ProductName | Category | ...

Relationship:
fact.FactOrders.ProductKey → dim.DimProduct.ProductKey
```

**Summary:**  
Each order line references a product, allowing you to see which products were purchased in each order, and retrieve product details by joining **fact.FactOrders** to **dim.DimProduct** on **ProductKey**.

## Q: Which customers have the most returns?

```sql
SELECT TOP 50 c.CustomerId, c.FirstName, c.LastName, c.Region, c.MembershipTier, COUNT(r.ReturnKey) AS ReturnCount
FROM fact.FactReturns r
JOIN dim.DimCustomer c ON r.CustomerKey = c.CustomerKey
GROUP BY c.CustomerId, c.FirstName, c.LastName, c.Region, c.MembershipTier
ORDER BY ReturnCount DESC, c.CustomerId
```

| CustomerId | FirstName | LastName | Region | MembershipTier | ReturnCount |
| --- | --- | --- | --- | --- | --- |
| CUST-02443 | Robert | Brown | Midwest | Silver | 5 |
| CUST-00623 | Joseph | Hopkins | West | Silver | 4 |
| CUST-01341 | Christine | Graham | West | Bronze | 4 |
| CUST-02695 | Andrea | Hernandez | West | Bronze | 4 |
| CUST-02796 | Paul | Maddox | Northeast | Bronze | 4 |
| CUST-00359 | Nicholas | Kim | Midwest | Gold | 3 |
| CUST-00363 | Stacey | Davis | Midwest | Gold | 3 |
| CUST-00999 | Andrea | Acosta | Midwest | Silver | 3 |
| CUST-01071 | Brenda | Malone | West | Silver | 3 |
| CUST-01133 | Bradley | Thomas | Midwest | Silver | 3 |
| CUST-01290 | Ray | West | Midwest | Bronze | 3 |
| CUST-01369 | Frederick | Wright | Southwest | Bronze | 3 |
| CUST-01425 | Zoe | Miller | Northeast | Bronze | 3 |
| CUST-01947 | Robert | Evans | Midwest | Silver | 3 |
| CUST-02821 | Linda | Hall | Southwest | Platinum | 3 |
| CUST-02826 | Corey | Brewer | Southwest | Silver | 3 |
| CUST-00084 | Brooke | Ortiz | Midwest | Silver | 2 |
| CUST-00295 | Brenda | Edwards | West | Silver | 2 |
| CUST-00629 | Julie | Bryant | Northeast | Bronze | 2 |
| CUST-00759 | Megan | Miranda | Southwest | Gold | 2 |
| CUST-00885 | Jennifer | Kane | West | Silver | 2 |
| CUST-00972 | Stephen | Willis | Southeast | Bronze | 2 |
| CUST-01179 | Joseph | Cooper | Northeast | Gold | 2 |
| CUST-01372 | Rebecca | Kaufman | Southwest | Bronze | 2 |
| CUST-01682 | Johnny | Miller | Midwest | Bronze | 2 |
| CUST-02761 | Kelly | Browning | Southeast | Silver | 2 |
| CUST-02915 | Elijah | Cooper | Northeast | Bronze | 2 |
| CUST-02929 | Tristan | Lewis | West | Bronze | 2 |
| CUST-00224 | Dustin | Hays | Southwest | Bronze | 1 |
| CUST-00252 | Jacqueline | Gutierrez | Midwest | Bronze | 1 |
| CUST-00391 | Alejandro | Deleon | Southeast | Bronze | 1 |
| CUST-00486 | Lisa | Dixon | Southeast | Bronze | 1 |
| CUST-00871 | Johnny | Goodwin | Southwest | Silver | 1 |
| CUST-00926 | Darin | Simmons | Northeast | Silver | 1 |
| CUST-01110 | Patricia | Brown | Midwest | Bronze | 1 |
| CUST-01258 | Sydney | Zuniga | Southeast | Silver | 1 |
| CUST-01315 | Sheri | Christensen | Midwest | Bronze | 1 |
| CUST-01324 | Sophia | Thompson | Northeast | Silver | 1 |
| CUST-01333 | Jennifer | Johnson | Southwest | Bronze | 1 |
| CUST-01371 | Tammy | Morris | Southeast | Gold | 1 |
| CUST-01877 | Brandon | Carter | West | Bronze | 1 |
| CUST-01953 | Maurice | Johnson | Midwest | Gold | 1 |
| CUST-02009 | Tyler | Green | West | Silver | 1 |
| CUST-02144 | Yolanda | Reed | Northeast | Silver | 1 |
| CUST-02220 | Ashley | Pena | West | Silver | 1 |
| CUST-02248 | Alexander | Adams | Southeast | Gold | 1 |
| CUST-02272 | Michael | Morris | Southeast | Platinum | 1 |
| CUST-02278 | Kayla | Johnson | Southwest | Bronze | 1 |
| CUST-02603 | Dylan | Williams | West | Bronze | 1 |
| CUST-02635 | Richard | Perry | Northeast | Bronze | 1 |

*50 rows*
